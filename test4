import random as rn
import numpy as np
import math
import matplotlib.pyplot as plt
import multiprocessing as mp

methods=['Random','Numpy','BadRandom','LCG']

sampals=10000000
runrange=1000

#Absolut Amount
AA = [0 for i in range(runrange)]

def LCG(min,max,seed):
    a = 7
    c = 31
    LCG = ((a*seed)+c) % runrange
    return int(LCG)

def bad_random(min,max,seed):
    c=round(max/2+((max+min)/2 * (math.cos(math.pi*math.cos(5000*seed)))))
    return int(c)

def CreateDistribution(type):
    AA = [0 for i in range(runrange)]
    x=1
    for i in range(sampals):
        AA[x] = AA[x]+1
        if type==0:
            x = rn.randint(0, len(AA)-1)
            continue
        if type==1:
            x = np.random.randint(0, len(AA))
            continue
        if type==2:
            x = bad_random(0, len(AA)-1,i)
            continue
        if type==3:
            x = LCG(0, len(AA)-1,i)
            continue
    AA[x] = AA[x]+1
    AA[1] = AA[1]-1
    return AA

def ChiCalc(AA):
    for i in range(runrange):
        x=(AA[i]-(sampals/runrange))
        chi = (x**2)/(sampals/runrange)
    return float(chi)

def Output(DIS,CHI):
    for i in range(0,len(methods)):
        print(methods[i]+" Distribution")
        print(DIS[i])
        print()
    for i in range(0,len(methods)):
        print(methods[i]+" Chi")
        print(CHI[i])
        print()
    print("Number of sampals: "+str(sampals))
    print("Range: "+str(runrange))

def Plot(DIS,CHI):
    plt.figure(figsize=(9, 2))

    plt.subplot(121)
    plt.bar(methods, CHI)
    plt.ylim([0, 4])

    plt.subplot(122)
    plt.ylim([0.4*sampals/runrange, 1.6*sampals/runrange])
    for i in range(len(methods)):
        x=[j for j in range(runrange)]
        plt.plot(x, DIS[i], label=methods[i])
    plt.show()

def CalcMT(DIS):
    pool = mp.Pool(mp.cpu_count())
    DIS = pool.map(CreateDistribution,[i for i in range(len(methods))])
    print(DIS)
    return DIS


DIS=[[] for i in range(len(methods))]
#DIS=[CreateDistribution(i) for i in range(len(methods))]

CHI=[[] for i in range(len(methods))]

if __name__ == "__main__":
    DIS = CalcMT(DIS)
    CHI=[ChiCalc(DIS[i]) for i in range(len(methods))]
    Output(DIS,CHI)
    Plot(DIS,CHI)
    exit()
exit()